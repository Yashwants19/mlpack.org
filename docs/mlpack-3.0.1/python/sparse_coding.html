<html >
<head >

<meta name="keywords" content="mlpack, libmlpack, c++, armadillo, machine learning, data mining, classification, regression, tree-based methods, dual-tree algorithm">
<meta name="description" content="mlpack: a fast, flexible c++ machine learning library">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title >mlpack: a fast, flexible c++ machine learning library</title>
</head><link rel="stylesheet" href="../../../style.css" /></link><link rel="stylesheet" href="../../style-python.css" /></link><link href="http://fonts.googleapis.com/css?family=Maven+Pro:500" rel="stylesheet" type="text/css" /></link>



<body ><br /></br>


<div class="titlebar">
   <a href="http://www.mlpack.org"><img src="../../../mlpack.png"></a>
</div>
<center >
<div class="mlnavbar">
  <div class="navcontainer">
   <div class="mlnavitem" name="mlnavmain"><a href="../../../index.html">main</a></div>
   <div class="mlnavitem" name="mlnavabout"><a href="../../../about.html">about</a></div>
   <div class="mlnavitem" name="mlnavdoc"><a href="../../../docs.html">docs</a></div>
   <div class="mlnavitem" name="mlnavhelp"><a href="../../../help.html">get help</a></div>
   <div class="mlnavitem" name="mlnavbugs"><a href="https://github.com/mlpack/mlpack">github</a></div>
  </div>
</div>
</center>
<div class="separator"></div>
<center >
<div class="mainsection smallertext pythonpage">
<h1><center>mlpack.sparse_coding</center></h1>
<font class="titlecode">sparse_coding(...)</font><br />
<font class="titlebold">Sparse Coding</font>
<p class="importcode">&gt;&gt;&gt; from mlpack import sparse_coding</p><p>An implementation of Sparse Coding with Dictionary Learning, which achieves sparsity via an l1-norm regularizer on the codes (LASSO) or an (l1+l2)-norm regularizer on the codes (the Elastic Net).  Given a dense data matrix X with d dimensions and n points, sparse coding seeks to find a dense dictionary matrix D with k atoms in d dimensions, and a sparse coding matrix Z with n points in k dimensions.</p>
</p>
<p>The original data matrix X can then be reconstructed as Z * D.  Therefore, this program finds a representation of each point in X as a sparse linear combination of atoms in the dictionary D.</p>
</p>
<p>The sparse coding is found with an algorithm which alternates between a dictionary step, which updates the dictionary D, and a sparse coding step, which updates the sparse coding matrix.</p>
</p>
<p>Once a dictionary D is found, the sparse coding model may be used to encode other matrices, and saved for future usage.</p>
</p>
<p>To run this program, either an input matrix or an already-saved sparse coding model must be specified.  An input matrix may be specified with the <font class="code">'training'</font> option, along with the number of atoms in the dictionary (specified with the <font class="code">'atoms'</font> parameter).  It is also possible to specify an initial dictionary for the optimization, with the <font class="code">'initial_dictionary'</font> parameter.  An input model may be specified with the <font class="code">'input_model'</font> parameter.</p>
</p>
<p>As an example, to build a sparse coding model on the dataset <font class="code">'data'</font> using 200 atoms and an l1-regularization parameter of 0.1, saving the model into <font class="code">'model'</font>, use </p>
</p>
<p class="codeblock"><font class="code">&gt;&gt;&gt; sparse_coding(training=data, atoms=200, lambda1=0.1)<br />
&gt;&gt;&gt; model = output['output_model']</font></p>
</p>
<p>Then, this model could be used to encode a new matrix, <font class="code">'otherdata'</font>, and save the output codes to <font class="code">'codes'</font>: </p>
</p>
<p class="codeblock"><font class="code">&gt;&gt;&gt; sparse_coding(input_model=model, test=otherdata)<br />
&gt;&gt;&gt; codes = output['codes']</font></p><h2>input options</h2>
<ul>
<li><font class="code">atoms</font> <font class="codetype">(int)</font>: Number of atoms in the dictionary.  Default value 15.</li><li><font class="code">copy_all_inputs</font> <font class="codetype">(bool)</font>: If specified, all input parameters will be deep copied before the method is run.  This is useful for debugging problems where the input parameters are being modified by the algorithm, but can slow down the code.</li><li><font class="code">initial_dictionary</font> <font class="codetype">(numpy matrix or arraylike, float dtype)</font>: Optional initial dictionary matrix.</li><li><font class="code">input_model</font> <font class="codetype">(mlpack.SparseCodingType)</font>: File containing input sparse coding model.</li><li><font class="code">lambda1</font> <font class="codetype">(float)</font>: Sparse coding l1-norm regularization parameter.  Default value 0.</li><li><font class="code">lambda2</font> <font class="codetype">(float)</font>: Sparse coding l2-norm regularization parameter.  Default value 0.</li><li><font class="code">max_iterations</font> <font class="codetype">(int)</font>: Maximum number of iterations for sparse coding (0 indicates no limit).  Default value 0.</li><li><font class="code">newton_tolerance</font> <font class="codetype">(float)</font>: Tolerance for convergence of Newton method.  Default value 1e-06.</li><li><font class="code">normalize</font> <font class="codetype">(bool)</font>: If set, the input data matrix will be normalized before coding.</li><li><font class="code">objective_tolerance</font> <font class="codetype">(float)</font>: Tolerance for convergence of the objective function.  Default value 0.01.</li><li><font class="code">seed</font> <font class="codetype">(int)</font>: Random seed.  If 0, 'std::time(NULL)' is used.  Default value 0.</li><li><font class="code">test</font> <font class="codetype">(numpy matrix or arraylike, float dtype)</font>: Optional matrix to be encoded by trained model.</li><li><font class="code">training</font> <font class="codetype">(numpy matrix or arraylike, float dtype)</font>: Matrix of training data (X).</li><li><font class="code">verbose</font> <font class="codetype">(bool)</font>: Display informational messages and the full list of parameters and timers at the end of execution.</li></ul>
<h2>output options</h2>
<p>The return value from the binding is a dict containing the following elements:</p>
<ul><li><font class="code">codes</font> <font class="codetype">(numpy matrix, float dtype)</font>: Matrix to save the output sparse codes of the test matrix (--test_file) to.</li><li><font class="code">dictionary</font> <font class="codetype">(numpy matrix, float dtype)</font>: Matrix to save the output dictionary to.</li><li><font class="code">output_model</font> <font class="codetype">(mlpack.SparseCodingType)</font>: File to save trained sparse coding model to.</li><ul>
</ul>
</div>
</body>
</html>
