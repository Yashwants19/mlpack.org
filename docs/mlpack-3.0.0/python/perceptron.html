<html >
<head >

<meta name="keywords" content="mlpack, libmlpack, c++, armadillo, machine learning, data mining, classification, regression, tree-based methods, dual-tree algorithm">
<meta name="description" content="mlpack: a scalable c++ machine learning library">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title >mlpack: a scalable c++ machine learning library</title>
</head><link rel="stylesheet" href="../../../style.css" /></link><link rel="stylesheet" href="../../style-python.css" /></link><link href="http://fonts.googleapis.com/css?family=Maven+Pro:500" rel="stylesheet" type="text/css" /></link>



<body ><br /></br>


<div class="titlebar">
   <a href="http://www.mlpack.org"><img src="../../../mlpack.png"></a>
</div>
<center >
<div class="mlnavbar">
  <div class="navcontainer">
   <div class="mlnavitem" name="mlnavmain"><a href="../../../index.html">main</a></div>
   <div class="mlnavitem" name="mlnavabout"><a href="../../../about.html">about</a></div>
   <div class="mlnavitem" name="mlnavdoc"><a href="../../../docs.html">docs</a></div>
   <div class="mlnavitem" name="mlnavhelp"><a href="../../../help.html">get help</a></div>
   <div class="mlnavitem" name="mlnavbugs"><a href="https://github.com/mlpack/mlpack">github</a></div>
  </div>
</div>
</center>
<div class="separator"></div>
<center >
<div class="mainsection smallertext pythonpage">
<h1><center>mlpack.perceptron</center></h1>
<font class="titlecode">perceptron(...)</font><br />
<font class="titlebold">Perceptron</font>
<p class="importcode">&gt;&gt;&gt; from mlpack import perceptron</p><p>This program implements a perceptron, which is a single level neural network. The perceptron makes its predictions based on a linear predictor function combining a set of weights with the feature vector.  The perceptron learning rule is able to converge, given enough iterations (specified using the <font class="code">'max_iterations'</font> parameter), if the data supplied is linearly separable.  The perceptron is parameterized by a matrix of weight vectors that denote the numerical weights of the neural network.</p>
</p>
<p>This program allows loading a perceptron from a model (via the <font class="code">'input_model'</font> parameter) or training a perceptron given training data (via the <font class="code">'training'</font> parameter), or both those things at once.  In addition, this program allows classification on a test dataset (via the <font class="code">'test'</font> parameter) and the classification results on the test set may be saved with the <font class="code">'output'</font>output parameter.  The perceptron model may be saved with the <font class="code">'output_model'</font> output parameter.</p>
</p>
<p>The training data given with the <font class="code">'training'</font> option may have class labels as its last dimension (so, if the training data is in CSV format, labels should be the last column).  Alternately, the <font class="code">'labels'</font> parameter may be used to specify a separate matrix of labels.</p>
</p>
<p>All these options make it easy to train a perceptron, and then re-use that perceptron for later classification.  The invocation below trains a perceptron on <font class="code">'training_data'</font> with labels <font class="code">'training_labels'</font>, and saves the model to <font class="code">'perceptron'</font>.</p>
</p>
<p class="codeblock"><font class="code">&gt;&gt;&gt; perceptron(training=training_data, labels=training_labels)<br />
&gt;&gt;&gt; perceptron = output['output_model']</font></p>
</p>
<p>Then, this model can be re-used for classification on the test data <font class="code">'test_data'</font>.  The example below does precisely that, saving the predicted classes to <font class="code">'predictions'</font>.</p>
</p>
<p class="codeblock"><font class="code">&gt;&gt;&gt; perceptron(input_model=perceptron, test=test_data)<br />
&gt;&gt;&gt; predictions = output['output']</font></p>
</p>
<p>Note that all of the options may be specified at once: predictions may be calculated right after training a model, and model training can occur even if an existing perceptron model is passed with the <font class="code">'input_model'</font> parameter.  However, note that the number of classes and the dimensionality of all data must match.  So you cannot pass a perceptron model trained on 2 classes and then re-train with a 4-class dataset.  Similarly, attempting classification on a 3-dimensional dataset with a perceptron that has been trained on 8 dimensions will cause an error.</p><h2>input options</h2>
<ul>
<li><font class="code">copy_all_inputs</font> <font class="codetype">(bool)</font>: If specified, all input parameters will be deep copied before the method is run.  This is useful for debugging problems where the input parameters are being modified by the algorithm, but can slow down the code.</li><li><font class="code">input_model</font> <font class="codetype">(mlpack.PerceptronModelType)</font>: Input perceptron model.</li><li><font class="code">labels</font> <font class="codetype">(numpy vector or array, int/long dtype)</font>: A matrix containing labels for the training set.</li><li><font class="code">max_iterations</font> <font class="codetype">(int)</font>: The maximum number of iterations the perceptron is to be run  Default value 1000.</li><li><font class="code">test</font> <font class="codetype">(numpy matrix or arraylike, float dtype)</font>: A matrix containing the test set.</li><li><font class="code">training</font> <font class="codetype">(numpy matrix or arraylike, float dtype)</font>: A matrix containing the training set.</li><li><font class="code">verbose</font> <font class="codetype">(bool)</font>: Display informational messages and the full list of parameters and timers at the end of execution.</li></ul>
<h2>output options</h2>
<p>The return value from the binding is a dict containing the following elements:</p>
<ul><li><font class="code">output</font> <font class="codetype">(numpy vector, int dtype)</font>: The matrix in which the predicted labels for the test set will be written.</li><li><font class="code">output_model</font> <font class="codetype">(mlpack.PerceptronModelType)</font>: Output for trained perceptron model.</li><ul>
</ul>
</div>
</body>
</html>
